@HEADER-COMMENT@


@HEADER@
# obviously
BuildRequires:	gcc-c++
# we have a parser
BuildRequires:	flex bison
# needed for all yast packages
BuildRequires:	yast2-devtools
# testsuite
BuildRequires:	dejagnu
# autodocs
BuildRequires:	doxygen
# docbook docs
BuildRequires:	docbook-xsl-stylesheets libxslt
# catalog: convert URIs to local filenames
BuildRequires:	sgml-skel
# logging
# renamed: http://lists.opensuse.org/opensuse-packaging/2007-11/msg00076.html
BuildRequires:	libblocxx-devel
# libycp includes crypto built-ins
BuildRequires:  libxcrypt-devel

# for SCR DBus service
BuildRequires:	dbus-1-devel dbus-1-x11 PolicyKit-devel

Summary:	YaST2 - Core Libraries
Requires:	perl = %{perl_version}
Provides:	liby2util = 2.16.1
Obsoletes:	liby2util < 2.16.1

%description
-

@HEADER-DEVEL@
Summary:	YaST2 - Core Libraries
Provides:	liby2util-devel = 2.16.1
Obsoletes:	liby2util-devel < 2.16.1
Requires:	libxcrypt-devel hwinfo-devel
Requires:	glibc-devel libstdc++-devel pcre-devel libblocxx-devel sysfsutils
# required for libscr
Requires:	PolicyKit-devel dbus-1-devel
# for FlexLexer.h; I think that this dependency could be made
# private but it seems not worth the effort
Requires:	flex

%description devel
-

@PREP@

@BUILD@

@INSTALL@
mkdir -p "$RPM_BUILD_ROOT"@logdir@
%perl_process_packlist

@CLEAN@

%post
/sbin/ldconfig
# bnc#485992, since oS 11.2
C=blacklist
if test -f /etc/modprobe.d/$C; then
     mv -f /etc/modprobe.d/$C /etc/modprobe.d/50-$C.conf
fi

%postun -p /sbin/ldconfig

%files
%defattr(-,root,root)

%dir %{_libdir}/YaST2
%if "%_lib" == "lib64"
%dir /usr/lib/YaST2
%endif
%dir /usr/share/YaST2

%dir %attr(0700,root,root) @logdir@
%dir @ybindir@
%dir @plugindir@
%dir @scrconfdir@
%dir @execcompdir@/servers
%dir @execcompdir@/servers_non_y2

/usr/bin/ycpc
%{_libdir}/lib*.so.*
@ybindir@/y2base
@ybindir@/startshell
@ybindir@/tty_wrapper
@ybindir@/md_autorun
@ybindir@/elf-arch
@plugindir@/lib*.so.*
@scrconfdir@/*.scr
@execcompdir@/servers/scr
@execcompdir@/servers_non_y2/ag_*
# perl part (stdio agents)
# *: regular build compresses them, debug does not
%_mandir/man3/ycp.3pm*
%_mandir/man3/YaST::SCRAgent.3pm*
%{perl_vendorlib}/ycp.pm
%dir %{perl_vendorlib}/YaST
%{perl_vendorlib}/YaST/SCRAgent.pm
#  .packlist
%{perl_vendorarch}/auto/ycp
/var/adm/perl-modules/%name
# DBus service
@ybindir@/SCR_dbus_server
# DBus service config
/usr/share/dbus-1/system-services/org.opensuse.yast.SCR.service
%config /etc/dbus-1/system.d/org.opensuse.yast.SCR.conf
# PolicyKit default policies
/usr/share/PolicyKit/policy/org.opensuse.yast.scr.policy

# DBus namespace service
@ybindir@/yast_modules_dbus_server
/usr/share/dbus-1/system-services/org.opensuse.YaST.modules.service
%config /etc/dbus-1/system.d/org.opensuse.YaST.modules.conf
/usr/share/PolicyKit/policy/org.opensuse.yast.module-manager.policy


%files devel
%defattr(-,root,root)
@ybindir@/ybcdump
%{_libdir}/lib*.so
%{_libdir}/lib*.la
@plugindir@/lib*.so
@plugindir@/lib*.la
@includedir@
@pkgconfigdir@/@RPMNAME@.pc
%doc @docdir@
%doc %{_datadir}/doc/yastdoc
@ydatadir@/devtools/bin/generateYCPWrappers
